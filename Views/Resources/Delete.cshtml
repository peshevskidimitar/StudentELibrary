@model StudentELibrary.Models.Resource

<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true" style="color: #2158b0;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Избриши</h5>
                <button type="button" class="btn-close btn-close-modal" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h5 class="card-title d-1"><strong>Наслов</strong>: @Model.Title</h5>
                <p class="card-text m-0"><strong>Автор/и</strong>: @Model.Author</p>
                <p class="card-text m-0"><strong>Јазик</strong>: @Model.Language</p>
                <p class="card-text m-0"><strong>Датум на издавање</strong>: @Model.DatePublished.ToString("dd.MM.yyyy")</p>
                <p class="card-text m-0"><strong>Предмет</strong>: @Model.Subject.Name</p>
                <p class="mt-3">Дали сте сигурни дека сакате да го избришете ресурсот?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-close-modal" data-bs-dismiss="modal">Затвори</button>
                <button id="delete-button" type="button" data-bs-dismiss="modal" class="btn btn-primary">Избриши</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $(".btn-close-modal").on('click', function () {
            $("#deleteView").empty();
        });

        $("#delete-button").on('click', function () {
            $.ajax({
                url: "/Resources/Delete/" + @Model.Id,
                method: "POST",
                success: function () {
                    $("#deleteView").empty();

                    let data = {}
                    $("#main-form").serializeArray().map(function (x) { if (data[x.name] == null) { data[x.name] = x.value; } });
                    $("#PageNumber").val(data['PageNumber']);
                    $.ajax({
                        url: '/Resources/RenderResources/',
                        type: 'POST',
                        data: data,
                        beforeSend: function () {
                            $("#partialView").empty();
                            $("#loader").removeClass("d-none");
                        },
                        error: function (err) {
                            console.log(err);
                        },
                    }).done(function (result) {
                        setTimeout(function () {
                            $("#loader").addClass("d-none");
                            $("#partialView").append(result);
                        }, 250)
                    })
                },
                error: function (err) {
                    console.log(err);
                }
            });
        });
    });
</script>